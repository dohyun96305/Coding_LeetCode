# Write your MySQL query statement below

# CAN VOTE ONE OR MORE OR NOT 
# EACH PERSON HAS 1 VOTE => VOTE EQUALLY SPLIT ACROSS 
# FIND CANDIDATE WHO GOT THE MOST VOTES 
# ORDER BY CANDIDATE ASC

WITH VOTE_NUM1 AS (
    SELECT VOTER, 1 / (COUNT(VOTER)) AS NUM1 
    FROM VOTES
    GROUP BY VOTER
    HAVING SUM(CANDIDATE IS NULL) = 0),

TOTAL_VOTE AS (
    SELECT A.CANDIDATE, SUM(NUM1) AS TOTAL_NUM1
    FROM VOTES AS A
    JOIN VOTE_NUM1 AS B ON A.VOTER = B.VOTER
    GROUP BY A.CANDIDATE), 

RANK_VOTE AS ( 
    SELECT CANDIDATE, RANK() OVER (ORDER BY TOTAL_NUM1 DESC) AS RANK1
    FROM TOTAL_VOTE)

SELECT CANDIDATE
FROM RANK_VOTE
WHERE RANK1 = 1
ORDER BY CANDIDATE ASC 